<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <script src="https://aframe.io/releases/0.8.2/aframe.min.js"></script>
  <script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/v4.2.0/dist/aframe-extras.min.js"></script>
  <script src="//cdn.rawgit.com/donmccurdy/aframe-physics-system/v3.2.0/dist/aframe-physics-system.min.js"></script>
  <script src="https://recast-api.donmccurdy.com/aframe-inspector-plugin-recast.js"></script>
  <title>Mesh to game</title>
</head>

<body>
  <script>
    AFRAME.registerComponent('nav-pointer', {
      init: function () {
        const el = this.el;
        // On click, send the NPC to the target location.
        el.addEventListener('click', (e) => {
          const ctrlEl = el.sceneEl.querySelector('[nav-agent]');
          ctrlEl.setAttribute('nav-agent', {
            active: true,
            destination: e.detail.intersection.point
          });
        });
        // When hovering on the nav mesh, show a green cursor.
        el.addEventListener('mouseenter', () => {
          el.setAttribute('material', { color: 'green' });
        });
        el.addEventListener('mouseleave', () => {
          el.setAttribute('material', { color: 'crimson' })
        });

        // Refresh the raycaster after models load.
        el.sceneEl.addEventListener('object3dset', () => {
          this.el.components.raycaster.refreshObjects();
        });
      }
    });
  </script>
  <a-scene inspector-plugin-recast>
    <a-entity id="npc" gltf-model="potatoe/scene.gltf" nav-agent="speed: 2" visible="false">
      <a-entity id="rig" movement-controls="constrainToNavMesh: true" position="0 0 0">
        <a-entity camera="active: true" position="0 2 0" look-controls="pointerLockEnabled: true">
          <a-cursor nav-pointer raycaster="objects: [nav-mesh]"></a-cursor>
        </a-entity>
      </a-entity>
    </a-entity>
    <!-- Nav Mesh -->
    <a-entity gltf-model="navmesh.gltf" nav-mesh visible="false"></a-entity>

    <!-- Scene -->
    <a-entity gltf-model="medieval_castle/scene.gltf" position="7 -13 0"></a-entity>
  </a-scene>
</body>

</html>