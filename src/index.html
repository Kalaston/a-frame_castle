<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Yolistli</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="shortcut icon" href="assets/favicon.png">
    <link rel="manifest" href="manifest.json">
</head>

<body>

    <a-scene stats renderer="antialias: false;
             gammaOutput: true;
             sortObjects: true;
             physicallyCorrectLights: true"
             data-is-home="true"
             teleport-refresh
             vr-mode-ui="enabled: true">

        <!-- Asset management system. -->
        <a-assets>
            <a-asset-item id="scenario" src="assets/castle/scene.gltf"></a-asset-item>
            <img id="pyramid" src="/assets/piramide.jpg">
            <img id="portalImg" src="/assets/img/portal.png">
            <img id="shadowImg" src="/assets/img/shadow.png">
            <img id="sliceImg" src="/assets/img/slice.png">

            <!-- Mixins -->
            <a-mixin id="hand"
                     teleport-controls="cameraRig: #cameraRig; teleportOrigin: #head; type: line; collisionEntities: [ground], [portal]; landingMaxAngle: 360; hitCylinderColor: #ff9f2b; curveHitColor: #FAFAFA; hitCylinderHeight: 0.05; checkCollisionChildren: false; hitEntityAlignNormal: false; maxLength: 15"
                     teleport-listener
            ></a-mixin>

            <a-mixin id="hoverAnimation"
                     animation="property: object3D.position.y; from: 1.6; to: 1.8; dir: alternate; loop: true; dur: 5000; easing: easeInOutCubic; pauseEvents: touched"></a-mixin>

            <a-mixin id="slice" slice9="color: #050505; src: #sliceImg; left: 50; right: 52; top: 50; bottom: 52; padding: 0.04"></a-mixin>

            <a-mixin id="portal"
                     look-at="#head"
                     geometry="primitive: circle; segments: 64"
                     material="shader: yoPortal; backgroundColor: #333; transparent: true"
                     animation__mouseenterscale="property: scale; from: 1 1 1; to: 1.1 1.1 1.1; easing: easeInOutQuad; dir: alternate; loop: true; startEvents: mouseenter; dur: 1000; pauseEvents: mouseleave"
            ></a-mixin>

        </a-assets>

        <!-- Nav Mesh -->
        <a-entity ground gltf-model="assets/navmesh.gltf" nav-mesh visible="false"></a-entity>

        <!-- Scene. -->
        <a-entity id="cameraRig">
            <a-entity id="head" position="0 1.6 0" camera look-controls="pointerLockEnabled:true">
                <!-- Control for Web and Mobile -->
                <a-entity position="0.1 -0.1 0" teleport-extras mixin="hand"
                          teleport-controls="startEvents: starttouch; endEvents: endtouch"></a-entity>
                <a-entity id="teleportFader" geometry="primitive: box" material="color: #111; shader: flat; side: back" visible="false"></a-entity>
            </a-entity>

            <!-- SECOND HAND: Primary hand. -->
            <a-entity id="left-hand" mixin="hand"  teleport-controls="startEvents: teleportstart; endEvents: teleportend; button: trigger"
                  vive-controls="hand: left" oculus-touch-controls="hand: left" microsoft-motion-controls="hand: left"
                  daydream-controls="hand: left">
            </a-entity>

            <!-- RIGHT HAND: Primary hand. -->
            <a-entity id="right-hand" mixin="hand" teleport-controls="startEvents: teleportstart; endEvents: teleportend; button: trigger"
                  vive-controls="hand: right" microsoft-motion-controls="hand: right" oculus-touch-controls="hand: right"
                  daydream-controls="hand: right">
            </a-entity>
        </a-entity>

        <a-entity gltf-model="#scenario" position="7 -13 0"></a-entity>

        <a-simple-sun-sky sun-position="-5 8 3"></a-simple-sun-sky>

        <!-- Portals -->

            <a-entity class="portal"
                      id="pyramid-portal"
                      portal
                      mixin="portal hoverAnimation"
                      yo-portal="href: templates/pyramid.html"
                      material="pano: assets/img/portal/piramide.jpg"
                      position="-9 0 -4">
                <a-entity class="portalEffect1"
                          obj-model="obj: assets/models/portal/portal.obj"
                          additive
                          material="color: #03c1e2; opacity: 0.6; depthWrite: false; shader: flat; transparent: true; src: #portalImg"
                          position="0 0 -0.017"
                          rotation="0 90 90"
                          scale="3.116 3.116 3.116"
                          animation="property: object3D.rotation.x; from: 0; to: 6.283185; dur: 10000; loop: true; easing: linear"></a-entity>
                <a-entity class="portalEffect2"
                          obj-model="obj: assets/models/portal/portal.obj"
                          additive
                          material="color: #f37132; opacity: 0.6; depthWrite: false; shader: flat; transparent: true; src: #portalImg"
                          position="0 0 -0.058"
                          rotation="0 90 90"
                          scale="3.078 0.969 3.078"
                          animation="property: object3D.rotation.x; from: 0; to: 6.283185; dur: 15000; loop: true; easing: linear"></a-entity>
                <a-entity class="portalText"
                          mixin="slice"
                          slice9="color:  #111; height: 0.3; width: 2.5; opacity: 0.7"
                          text="color: #4ef580; align: center; value: Piramide; side: double; width: 4; zOffset: 0.01"
                          position="0 1.3 0"></a-entity>
            </a-entity>


    </a-scene>

</body>

</html>
